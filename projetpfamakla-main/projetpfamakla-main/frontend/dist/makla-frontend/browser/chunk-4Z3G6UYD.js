import{c}from"./chunk-BRHEW7GJ.js";import{a as m}from"./chunk-2LUDLJ2U.js";import{M as n,Q as u,U as a,Xb as l,k as s}from"./chunk-OOT27GPI.js";var f=(()=>{let r=class r{constructor(e,t){this.http=e,this.router=t,this.apiUrl=`${m.apiUrl}/auth`;let o=localStorage.getItem("currentUser");this.currentUserSubject=new s(o?JSON.parse(o):null),this.currentUser=this.currentUserSubject.asObservable()}get currentUserValue(){return this.currentUserSubject.value}get isAuthenticated(){return!!this.getToken()}login(e){return this.http.post(`${this.apiUrl}/login`,e).pipe(n(t=>{t.token&&(localStorage.setItem("token",t.token),localStorage.setItem("currentUser",JSON.stringify({username:t.username})),this.currentUserSubject.next({id:0,username:t.username,email:"",firstName:"",lastName:"",role:"USER"}))}))}register(e){return this.http.post(`${this.apiUrl}/register`,e).pipe(n(t=>{t.token&&(localStorage.setItem("token",t.token),localStorage.setItem("currentUser",JSON.stringify({username:t.username})),this.currentUserSubject.next({id:0,username:t.username,email:e.email,firstName:e.firstName,lastName:e.lastName,role:"USER"}))}))}logout(){localStorage.removeItem("token"),localStorage.removeItem("currentUser"),this.currentUserSubject.next(null),this.router.navigate(["/login"])}getToken(){return localStorage.getItem("token")}validateToken(){return this.http.get(`${this.apiUrl}/validate`,{headers:{Authorization:`Bearer ${this.getToken()}`}})}getCurrentUser(){return this.currentUserSubject.value}};r.\u0275fac=function(t){return new(t||r)(a(l),a(c))},r.\u0275prov=u({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})();export{f as a};
